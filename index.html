<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>造咖網站成效報告</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            background: #E0E0E0;
            padding: 20px;
            line-height: 1.8;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: #FFC107;
            padding: 40px 30px;
            text-align: center;
            color: #333;
        }

        .header h1 {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 18px;
            opacity: 0.95;
        }

        .content {
            padding: 40px 30px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 26px;
            font-weight: bold;
            color: #FF9933;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #FF9933;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #e1e8ed 100%);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-3px);
        }

        .metric-card h3 {
            font-size: 15px;
            color: #666;
            margin-bottom: 10px;
        }

        .metric-card .value {
            font-size: 32px;
            font-weight: bold;
            color: #FF6666;
            margin-bottom: 5px;
        }

        .metric-card .change {
            font-size: 15px;
            color: #4CAF50;
            font-weight: bold;
        }

        .text-content {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #FF9933;
        }

        .text-content p {
            font-size: 20px;
            color: #333;
            line-height: 1.9;
            margin-bottom: 12px;
        }

        .text-content p:last-child {
            margin-bottom: 0;
        }

        .chart-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .chart-wrapper {
            position: relative;
            height: 350px;
            margin-bottom: 15px;
            width: 100%;
            overflow-x: auto;
        }

        .chart-wrapper.daily-chart {
            height: 320px;
        }

        .chart-wrapper canvas {
            min-width: 100%;
        }

        .article-list {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .article-item {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            transition: background 0.3s ease;
        }

        .article-item:hover {
            background: #e8e8e8;
        }

        .article-item:last-child {
            border-bottom: none;
        }

        .article-rank {
            display: inline-block;
            width: 32px;
            height: 32px;
            background: #FF9933;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 32px;
            margin-right: 12px;
            font-weight: bold;
            font-size: 15px;
        }

        .article-title {
            font-size: 16px;
            color: #333;
            line-height: 1.6;
        }

        .article-views {
            color: #FF6666;
            font-weight: bold;
            font-size: 15px;
            margin-top: 5px;
            display: block;
            margin-left: 44px;
        }

        .article-link {
            color: #1976D2;
            font-size: 14px;
            margin-left: 44px;
            display: block;
            margin-top: 3px;
            word-break: break-all;
            text-decoration: none;
        }

        .article-link:hover {
            text-decoration: underline;
        }

        .keyword-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .keyword-item {
            background: white;
            padding: 18px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .keyword-name {
            font-weight: bold;
            color: #7B1FA2;
            font-size: 17px;
            margin-bottom: 8px;
        }

        .keyword-stats {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .header p {
                font-size: 14px;
            }

            .content {
                padding: 25px 20px;
            }

            .section-title {
                font-size: 20px;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .metric-card {
                padding: 20px;
            }

            .metric-card .value {
                font-size: 28px;
            }

            .text-content {
                padding: 20px;
            }

            .text-content p {
                font-size: 20px;
            }

            .chart-wrapper {
                height: 300px;
                overflow-x: auto;
            }

            .chart-wrapper.daily-chart {
                height: 320px;
            }

            .chart-wrapper canvas {
                min-width: 600px;
            }

            .chart-wrapper.category-chart canvas {
                min-width: 650px;
            }

            .article-list {
                padding: 20px;
            }

            .article-item {
                padding: 12px;
            }

            .article-rank {
                width: 28px;
                height: 28px;
                line-height: 28px;
                font-size: 14px;
            }

            .article-title {
                font-size: 15px;
            }

            .article-views,
            .article-link {
                margin-left: 40px;
                font-size: 14px;
            }

            .keyword-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 20px;
            }

            .section-title {
                font-size: 18px;
            }

            .metric-card .value {
                font-size: 24px;
            }

            .text-content p {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>造咖週報</h1>
            <p>2025年10月22日 - 10月28日</p>
        </div>

        <div class="content">
            <!-- 總覽指標 -->
            <div class="section">
                <h2 class="section-title">📊 總覽</h2>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <h3>總 PV</h3>
                        <div class="value">405萬</div>
                        <div class="change">+4.7%</div>
                    </div>
                    <div class="metric-card">
                        <h3>使用者</h3>
                        <div class="value">122.9萬</div>
                        <div class="change">+4.7%</div>
                    </div>
                    <div class="metric-card">
                        <h3>新使用者</h3>
                        <div class="value">68.6萬</div>
                        <div class="change">+8.9%</div>
                    </div>
                </div>

                <div class="text-content">
                    <p>本週網站流量穩健成長,總 PV 再度突破 400 萬,達 4,051,005,每日平均 PV 約 57.9 萬。單日最高為 10/27(69.9 萬),主要受「藝人閃兵案開庭」、「翻轉布丁限量版」及「于朦朧事件延燒」等話題帶動。娛樂爭議與消費新品並行推升社群熱度,使整體曝光度明顯上升。</p>
                </div>

                <div class="chart-container">
                    <h3 style="color: #666; margin-bottom: 15px; font-size: 18px;">每日流量趨勢</h3>
                    <div class="chart-wrapper daily-chart">
                        <canvas id="dailyChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 流量來源分析 -->
            <div class="section">
                <h2 class="section-title">📱 流量來源分析</h2>
                
                <div class="text-content">
                    <p>社群流量仍為主力來源,占比達 83.9%。m.facebook.com(224 萬 PV,-4.2%)與 lm.facebook.com(107 萬 PV,+4.5%)持續穩定,Direct 流量大幅成長 72.4%,顯示品牌直接訪問率顯著提升。Google Organic Search 成長 91.1%,為本週關鍵亮點。整體平均每位使用者瀏覽頁數 3.3(+0.1%),維持良好互動品質。</p>
                </div>

                <div class="chart-container">
                    <h3 style="color: #666; margin-bottom: 15px; font-size: 18px;">流量來源占比</h3>
                    <div class="chart-wrapper">
                        <canvas id="sourceChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3 style="color: #666; margin-bottom: 15px; font-size: 18px;">主要社群來源</h3>
                    <div class="chart-wrapper">
                        <canvas id="socialChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 關鍵字熱搜榜 -->
            <div class="section">
                <h2 class="section-title">🔍 關鍵字熱搜榜 TOP 5</h2>
                
                <div class="text-content">
                    <p>搜尋曝光量 779,970(-35.5%),點擊次數 31,447(-27.3%),CTR 為 4.03%(+12.7%),平均排名 9.42(-2.3%)。熱門搜尋詞包括「范世錡」、「統一布丁」、「翻轉布丁」、「命懸一生」、「于朦朧」等,娛樂與生活話題並列,顯示社群輿論與消費搜尋持續交錯影響。</p>
                </div>

                <div class="text-content">
                    <div class="keyword-grid">
                        <div class="keyword-item">
                            <div class="keyword-name">1. 范世錡</div>
                            <div class="keyword-stats">
                                曝光:18,627 (+12,882)<br>
                                點擊:2,221 (+1,210)<br>
                                點擊率:11.9%
                            </div>
                        </div>
                        <div class="keyword-item">
                            <div class="keyword-name">2. 統一布丁</div>
                            <div class="keyword-stats">
                                曝光:3,480 (+1,845)<br>
                                點擊:856 (+785)<br>
                                點擊率:24.6%
                            </div>
                        </div>
                        <div class="keyword-item">
                            <div class="keyword-name">3. 翻轉布丁</div>
                            <div class="keyword-stats">
                                曝光:7,102 (+5,196)<br>
                                點擊:752 (+409)<br>
                                點擊率:10.6%
                            </div>
                        </div>
                        <div class="keyword-item">
                            <div class="keyword-name">4. 命懸一生</div>
                            <div class="keyword-stats">
                                曝光:5,469 (+4,380)<br>
                                點擊:665 (+604)<br>
                                點擊率:12.2%
                            </div>
                        </div>
                        <div class="keyword-item">
                            <div class="keyword-name">5. 于朦朧</div>
                            <div class="keyword-stats">
                                曝光:4,897 (-7,719)<br>
                                點擊:519 (-608)<br>
                                點擊率:10.6%
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 內容分類表現 -->
            <div class="section">
                <h2 class="section-title">📂 內容分類表現</h2>

                <div class="chart-container">
                    <h3 style="color: #666; margin-bottom: 15px; font-size: 18px;">各分類 PV 占比與成長</h3>
                    <div class="chart-wrapper category-chart">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>

                <div class="text-content">
                    <p><strong>話題類(36%): </strong>145.9 萬 PV,-12.3%。雖占比最高但有所下滑,需開發新議題維持熱度。</p>
                    <p><strong>娛樂類(18.6%): </strong>75.4 萬 PV,+55.3%。本週最大亮點,于朦朧、閃兵案等議題帶動爆發性成長。</p>
                    <p><strong>健康類(17.3%): </strong>70.1 萬 PV,-10%。需加強選題與推廣策略。</p>
                    <p><strong>生活類(6.4%): </strong>26 萬 PV,+62.8%。成長強勁,內容多元化策略奏效。</p>
                </div>
            </div>

            <!-- 週PV前五文章 -->
            <div class="section">
                <h2 class="section-title">🏆 週 PV 前五文章</h2>
                
                <div class="article-list">
                    <div class="article-item">
                        <span class="article-rank">1</span>
                        <span class="article-title">比「翻轉布丁」還少見!網友買到「超級限量版」</span>
                        <span class="article-views">PV 115,251</span>
                        <a href="https://cava.tw/topic/fun-fact/261275" target="_blank" class="article-link">https://cava.tw/topic/fun-fact/261275</a>
                    </div>
                    <div class="article-item">
                        <span class="article-rank">2</span>
                        <span class="article-title">快訊/藝人閃兵案開庭!被告8藝人全員認罪求緩刑遭拒</span>
                        <span class="article-views">PV 106,975</span>
                        <a href="https://cava.tw/topic/news/261387" target="_blank" class="article-link">https://cava.tw/topic/news/261387</a>
                    </div>
                    <div class="article-item">
                        <span class="article-rank">3</span>
                        <span class="article-title">王大陸閃兵案擴大!檢警拘提11位藝人名單</span>
                        <span class="article-views">PV 101,835</span>
                        <a href="https://cava.tw/entertainment/celebrity/257860" target="_blank" class="article-link">https://cava.tw/entertainment/celebrity/257860</a>
                    </div>
                    <div class="article-item">
                        <span class="article-rank">4</span>
                        <span class="article-title">她拿「于朦朧生死交易」?日記疑曝光!YTR揭隱情</span>
                        <span class="article-views">PV 96,562</span>
                        <a href="https://cava.tw/topic/news/261276" target="_blank" class="article-link">https://cava.tw/topic/news/261276</a>
                    </div>
                    <div class="article-item">
                        <span class="article-rank">5</span>
                        <span class="article-title">疑涉于朦朧事件!焦邁奇「男男私密照」外流</span>
                        <span class="article-views">PV 101,684</span>
                        <a href="https://cava.tw/topic/news/261339" target="_blank" class="article-link">https://cava.tw/topic/news/261339</a>
                    </div>
                </div>

                <div class="text-content">
                    <p>本週熱門文章以娛樂話題與消費新品為主。「翻轉布丁限量版」、「閃兵案」、「于朦朧事件」等話題持續發酵,顯示讀者對爭議性娛樂新聞與限量商品高度關注。話題類與娛樂類文章佔據前五名,健康類文章本週未進入前五,需加強選題策略。</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 每日流量趨勢
        const dailyCtx = document.getElementById('dailyChart').getContext('2d');
        new Chart(dailyCtx, {
            type: 'line',
            data: {
                labels: ['10/22', '10/23', '10/24', '10/25', '10/26', '10/27', '10/28'],
                datasets: [{
                    label: '每日 PV',
                    data: [614000, 699000, 486000, 445000, 525000, 644000, 638000],
                    borderColor: '#FF6666',
                    backgroundColor: 'rgba(255, 102, 102, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                layout: {
                    padding: {
                        top: 35
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return '每日 PV: ' + context.parsed.y.toLocaleString();
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return (value / 10000) + '萬';
                            }
                        }
                    }
                }
            },
            plugins: [{
                afterDatasetsDraw: function(chart) {
                    const ctx = chart.ctx;
                    chart.data.datasets.forEach(function(dataset, i) {
                        const meta = chart.getDatasetMeta(i);
                        if (!meta.hidden) {
                            meta.data.forEach(function(element, index) {
                                ctx.fillStyle = '#666';
                                const fontSize = 12;
                                const fontStyle = 'bold';
                                const fontFamily = 'Microsoft JhengHei';
                                ctx.font = fontStyle + ' ' + fontSize + 'px ' + fontFamily;
                                const dataString = (dataset.data[index] / 10000).toFixed(1) + '萬';
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'bottom';
                                const padding = 8;
                                const position = element.tooltipPosition();
                                ctx.fillText(dataString, position.x, position.y - padding);
                            });
                        }
                    });
                }
            }]
        });

        // 流量來源占比 - 使用英文標籤和引導線
        const sourceCtx = document.getElementById('sourceChart').getContext('2d');
        new Chart(sourceCtx, {
            type: 'doughnut',
            data: {
                labels: ['Organic Social', 'Organic Search', 'Direct', 'Referral'],
                datasets: [{
                    data: [83.9, 8.1, 6.5, 1.5],
                    backgroundColor: ['#FF6666', '#FF9933', '#4CAF50', '#9E9E9E']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 15,
                            font: {
                                size: 13
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.parsed + '%';
                            }
                        }
                    }
                }
            },
            plugins: [{
                afterDatasetsDraw: function(chart) {
                    const ctx = chart.ctx;
                    const dataset = chart.data.datasets[0];
                    const meta = chart.getDatasetMeta(0);
                    
                    meta.data.forEach(function(element, index) {
                        const value = dataset.data[index];
                        const label = chart.data.labels[index];
                        
                        // 只在大區塊顯示百分比(>5%)
                        if (value > 5) {
                            ctx.fillStyle = '#fff';
                            const fontSize = 16;
                            const fontStyle = 'bold';
                            const fontFamily = 'Microsoft JhengHei';
                            ctx.font = fontStyle + ' ' + fontSize + 'px ' + fontFamily;
                            const dataString = value + '%';
                            const position = element.tooltipPosition();
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            ctx.fillText(dataString, position.x, position.y);
                        } else {
                            // 小區塊使用引導線
                            const position = element.tooltipPosition();
                            const centerX = chart.chartArea.left + (chart.chartArea.right - chart.chartArea.left) / 2;
                            const centerY = chart.chartArea.top + (chart.chartArea.bottom - chart.chartArea.top) / 2;
                            
                            // 計算引導線終點
                            const angle = Math.atan2(position.y - centerY, position.x - centerX);
                            const radius = (element.outerRadius + element.innerRadius) / 2;
                            const x1 = centerX + Math.cos(angle) * element.outerRadius;
                            const y1 = centerY + Math.sin(angle) * element.outerRadius;
                            const x2 = centerX + Math.cos(angle) * (element.outerRadius + 25);
                            const y2 = centerY + Math.sin(angle) * (element.outerRadius + 25);
                            const x3 = x2 + (x2 > centerX ? 35 : -35);
                            
                            // 畫引導線
                            ctx.strokeStyle = '#666';
                            ctx.lineWidth = 1.5;
                            ctx.beginPath();
                            ctx.moveTo(x1, y1);
                            ctx.lineTo(x2, y2);
                            ctx.lineTo(x3, y2);
                            ctx.stroke();
                            
                            // 顯示文字
                            ctx.fillStyle = '#666';
                            ctx.font = 'bold 13px Microsoft JhengHei';
                            ctx.textAlign = x2 > centerX ? 'left' : 'right';
                            ctx.textBaseline = 'middle';
                            ctx.fillText(value + '%', x3 + (x2 > centerX ? 5 : -5), y2);
                        }
                    });
                }
            }]
        });

        // 主要社群來源
        const socialCtx = document.getElementById('socialChart').getContext('2d');
        new Chart(socialCtx, {
            type: 'bar',
            data: {
                labels: ['m.facebook.com', 'lm.facebook.com', 'l.facebook.com', 'l.threads.com'],
                datasets: [{
                    label: 'PV(萬)',
                    data: [224, 107, 7.9, 2.5],
                    backgroundColor: ['#FF6666', '#FF8888', '#FFAAAA', '#FFCCCC']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                layout: {
                    padding: {
                        top: 25
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.parsed.y + ' 萬 PV';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            },
            plugins: [{
                afterDatasetsDraw: function(chart) {
                    const ctx = chart.ctx;
                    chart.data.datasets.forEach(function(dataset, i) {
                        const meta = chart.getDatasetMeta(i);
                        if (!meta.hidden) {
                            meta.data.forEach(function(element, index) {
                                ctx.fillStyle = '#666';
                                const fontSize = 13;
                                const fontStyle = 'bold';
                                const fontFamily = 'Microsoft JhengHei';
                                ctx.font = fontStyle + ' ' + fontSize + 'px ' + fontFamily;
                                const dataString = dataset.data[index] + '萬';
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'bottom';
                                const padding = 6;
                                const position = element.tooltipPosition();
                                ctx.fillText(dataString, position.x, position.y - padding);
                            });
                        }
                    });
                }
            }]
        });

        // 內容分類表現 - 負數用紅色
        const categoryCtx = document.getElementById('categoryChart').getContext('2d');
        const categoryGrowth = [-12.3, 55.3, -10, 62.8, 0];
        const growthColors = categoryGrowth.map(val => val < 0 ? '#F44336' : '#4CAF50');
        
        new Chart(categoryCtx, {
            type: 'bar',
            data: {
                labels: ['話題', '娛樂', '健康', '生活', '美妝'],
                datasets: [
                    {
                        label: 'PV(萬)',
                        data: [145.9, 75.4, 70.1, 26, 22.4],
                        backgroundColor: '#FF9933',
                        yAxisID: 'y'
                    },
                    {
                        label: '成長率(%)',
                        data: categoryGrowth,
                        backgroundColor: growthColors,
                        yAxisID: 'y1'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                layout: {
                    padding: {
                        top: 30
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.dataset.label || '';
                                return label + ': ' + context.parsed.y;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        type: 'linear',
                        position: 'left',
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'PV(萬)'
                        }
                    },
                    y1: {
                        type: 'linear',
                        position: 'right',
                        grid: {
                            drawOnChartArea: false
                        },
                        title: {
                            display: true,
                            text: '成長率(%)'
                        }
                    }
                }
            },
            plugins: [{
                afterDatasetsDraw: function(chart) {
                    const ctx = chart.ctx;
                    chart.data.datasets.forEach(function(dataset, datasetIndex) {
                        const meta = chart.getDatasetMeta(datasetIndex);
                        if (!meta.hidden) {
                            meta.data.forEach(function(element, index) {
                                // 根據資料集和數值決定顏色
                                if (datasetIndex === 0) {
                                    ctx.fillStyle = '#333';
                                } else {
                                    // 成長率:負數紅色,正數深綠
                                    ctx.fillStyle = dataset.data[index] < 0 ? '#F44336' : '#2E7D32';
                                }
                                
                                const fontSize = 13;
                                const fontStyle = 'bold';
                                const fontFamily = 'Microsoft JhengHei';
                                ctx.font = fontStyle + ' ' + fontSize + 'px ' + fontFamily;
                                
                                let dataString;
                                if (datasetIndex === 0) {
                                    dataString = dataset.data[index] + '萬';
                                } else {
                                    dataString = dataset.data[index] + '%';
                                }
                                
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'bottom';
                                const padding = 6;
                                const position = element.tooltipPosition();
                                ctx.fillText(dataString, position.x, position.y - padding);
                            });
                        }
                    });
                }
            }]
        });
    </script>
</body>
</html>
